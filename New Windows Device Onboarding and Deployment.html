<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Impact Property Solutions - Windows Device Deployment Worksheet</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-tertiary: #f5f5f5;
            --text-primary: #1a1a1a;
            --text-secondary: #4a4a4a;
            --text-tertiary: #6a6a6a;
            --accent-primary: #1a5490;
            --accent-secondary: #2d6ba0;
            --accent-hover: #0d3d6b;
            --border-color: #d1d1d1;
            --code-bg: #fafafa;
            --code-border: #e5e5e5;
            --success: #107c10;
            --warning: #ffb900;
            --error: #d13438;
            --info: #1a5490;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: #1e1e1e;
            --bg-secondary: #252525;
            --bg-tertiary: #2d2d2d;
            --text-primary: #e8e8e8;
            --text-secondary: #b8b8b8;
            --text-tertiary: #888888;
            --accent-primary: #4a9eff;
            --accent-secondary: #5ba5ff;
            --accent-hover: #3a8eef;
            --border-color: #404040;
            --code-bg: #2a2a2a;
            --code-border: #3a3a3a;
            --success: #4ec04e;
            --warning: #ffcc00;
            --error: #ff6b6b;
            --info: #4a9eff;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--bg-primary);
        }

        header {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: center;
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 0.95rem;
            opacity: 0.95;
        }

        .device-info {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-primary);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .device-info h2 {
            color: var(--accent-primary);
            font-size: 1.3rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--accent-primary);
            padding-bottom: 0.5rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-item label {
            font-weight: bold;
            color: var(--accent-primary);
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
        }

        .info-item input,
        .info-item select {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: inherit;
            font-size: 1rem;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .info-item input:focus,
        .info-item select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(26, 84, 144, 0.1);
        }

        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            page-break-inside: avoid;
        }

        .section h2 {
            color: var(--accent-primary);
            font-size: 1.4rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--accent-primary);
            padding-bottom: 0.5rem;
        }

        .section h3 {
            color: var(--accent-secondary);
            font-size: 1.1rem;
            margin-top: 1rem;
            margin-bottom: 0.8rem;
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
            margin: 0.6rem 0;
            padding: 0.5rem;
            background: var(--bg-primary);
            border-radius: 4px;
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .checklist-item label {
            cursor: pointer;
            flex: 1;
            font-size: 0.95rem;
        }

        .checklist-item input[type="checkbox"]:checked + label {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .timestamp {
            display: flex;
            gap: 1rem;
            margin: 0.8rem 0;
            align-items: center;
        }

        .timestamp label {
            font-weight: bold;
            color: var(--accent-primary);
            min-width: 120px;
        }

        .timestamp input {
            padding: 0.4rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: inherit;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .notes {
            width: 100%;
            min-height: 80px;
            padding: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: inherit;
            font-size: 0.95rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            resize: vertical;
        }

        .notes:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(26, 84, 144, 0.1);
        }

        .alert {
            padding: 0.8rem;
            border-radius: 6px;
            margin: 1rem 0;
            border-left: 4px solid;
            font-size: 0.9rem;
        }

        .alert-warning {
            background: rgba(255, 185, 0, 0.1);
            border-left-color: var(--warning);
            color: #cc9900;
        }

        .alert-error {
            background: rgba(211, 52, 56, 0.1);
            border-left-color: var(--error);
            color: var(--error);
        }

        .alert-info {
            background: rgba(26, 84, 144, 0.1);
            border-left-color: var(--info);
            color: var(--info);
        }

        .alert-success {
            background: rgba(16, 124, 16, 0.1);
            border-left-color: var(--success);
            color: var(--success);
        }

        code {
            background: var(--code-bg);
            border: 1px solid var(--code-border);
            border-radius: 4px;
            padding: 0.2rem 0.4rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: var(--accent-primary);
        }

        pre {
            background: var(--code-bg);
            border: 1px solid var(--code-border);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
            font-size: 0.85rem;
        }

        pre code {
            background: none;
            border: none;
            padding: 0;
        }

        .quick-ref {
            background: var(--bg-tertiary);
            border-left: 4px solid var(--accent-primary);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .quick-ref h4 {
            color: var(--accent-primary);
            margin-bottom: 0.5rem;
        }

        .quick-ref ul {
            margin-left: 1.5rem;
            font-size: 0.9rem;
        }

        .quick-ref a {
            color: var(--accent-primary);
            text-decoration: none;
        }

        .quick-ref a:hover {
            text-decoration: underline;
        }

        .signoff {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-primary);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .signoff h2 {
            color: var(--accent-primary);
            margin-bottom: 1rem;
        }

        .signoff-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .signoff-item {
            display: flex;
            flex-direction: column;
        }

        .signoff-item label {
            font-weight: bold;
            color: var(--accent-primary);
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
        }

        .signoff-item input,
        .signoff-item select {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: inherit;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 2px 4px var(--shadow);
        }

        .theme-toggle:hover {
            background: var(--accent-hover);
        }

        @media print {
            .theme-toggle {
                display: none;
            }
            .section {
                page-break-inside: avoid;
            }
            body {
                padding: 10px;
            }
        }

        .status-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 1rem;
        }

        .status-success {
            background: var(--success);
            color: white;
        }

        .status-warning {
            background: var(--warning);
            color: #1a1a1a;
        }

        .status-error {
            background: var(--error);
            color: white;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">Dark Mode</button>

    <div class="container">
        <header>
            <h1>Impact Property Solutions</h1>
            <p>Windows Device Deployment Worksheet</p>
            <p style="font-size: 0.85rem; margin-top: 0.5rem;">Quick Reference Checklist for IT Team</p>
        </header>

        <div class="device-info">
            <h2>Device Information</h2>
            <div class="info-grid">
                <div class="info-item">
                    <label for="device-serial">Device Serial Number *</label>
                    <input type="text" id="device-serial" placeholder="Enter serial number" required>
                </div>
                <div class="info-item">
                    <label for="device-hostname">Device Hostname</label>
                    <input type="text" id="device-hostname" placeholder="Will be auto-generated">
                </div>
                <div class="info-item">
                    <label for="target-user">Target User (Email) *</label>
                    <input type="email" id="target-user" placeholder="user@impactpropertysolutions.com" required>
                </div>
                <div class="info-item">
                    <label for="deployment-date">Deployment Date *</label>
                    <input type="date" id="deployment-date" required>
                </div>
                <div class="info-item">
                    <label for="engineer-name">Engineer Name *</label>
                    <input type="text" id="engineer-name" placeholder="Your full name" required>
                </div>
                <div class="info-item">
                    <label for="device-type">Device Type</label>
                    <select id="device-type">
                        <option value="laptop">Laptop</option>
                        <option value="desktop">Desktop</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Phase 1: Pre-Deployment Checklist</h2>
            <div class="alert alert-warning">
                <strong>Complete these checks BEFORE starting device setup</strong>
            </div>

            <h3>Dell Pre-Provisioning Status</h3>
            <div class="checklist-item">
                <input type="checkbox" id="pre-dell-check">
                <label for="pre-dell-check">Device was Dell pre-provisioned (check order confirmation or device packaging for pre-provisioning notation)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="pre-dell-verify">
                <label for="pre-dell-verify">Verified device hardware hash is already in Autopilot (if Dell pre-provisioned)</label>
            </div>
            <div class="alert alert-info">
                <strong>Note:</strong> Dell pre-provisioned devices use Azure AD Tenant ID and domain name (<code>impactpropertysolutions.com</code>) to automatically register with Autopilot. These devices skip manual registration (Phase 3).
            </div>

            <h3>Hardware Hash & Autopilot Status</h3>
            <div class="checklist-item">
                <input type="checkbox" id="pre-hash-check">
                <label for="pre-hash-check">Device hardware hash is imported in Autopilot (check Endpoint Manager → Devices → Windows enrollment → Devices)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="pre-profile-check">
                <label for="pre-profile-check">Device is assigned to "Impact Standard Profile" (or correct Autopilot profile)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="pre-license-check">
                <label for="pre-license-check">Target user has Microsoft 365 E3 license assigned (verify in admin.microsoft.com)</label>
            </div>


            <div class="alert alert-info">
                <strong>Note:</strong> If hardware hash is already imported (via Dell pre-provisioning or manual import), skip manual registration (Phase 3) and proceed to Phase 4.
            </div>
        </div>

        <div class="section">
            <h2>Phase 2: Device Setup & Initial Configuration</h2>
            
            <h3>Physical Setup</h3>
            <div class="checklist-item">
                <input type="checkbox" id="setup-unbox">
                <label for="setup-unbox">Device unboxed and power adapter connected</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="setup-network">
                <label for="setup-network">Network connectivity confirmed (wired Ethernet preferred)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="setup-power">
                <label for="setup-power">Device powered on successfully</label>
            </div>

            <h3>Windows OOBE (Out-of-Box Experience)</h3>
            <div class="checklist-item">
                <input type="checkbox" id="oobe-language">
                <label for="oobe-language">Language and region selected</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="oobe-terms">
                <label for="oobe-terms">Terms and conditions accepted</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="oobe-no-local">
                <label for="oobe-no-local">NO local account created - proceeded to organizational sign-in</label>
            </div>

            <h3>Organizational Sign-In</h3>
            <div class="checklist-item">
                <input type="checkbox" id="signin-org">
                <label for="signin-org">Signed in with organizational account (@impactpropertysolutions.com)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="signin-mfa">
                <label for="signin-mfa">MFA completed (or registered if new user)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="signin-mfa-update">
                <label for="signin-mfa-update">If admin used own phone for MFA, updated target user's MFA registration</label>
            </div>


            <div class="quick-ref">
                <h4>Quick Reference: MFA Update Steps</h4>
                <ul>
                    <li>Go to admin.microsoft.com or portal.azure.com</li>
                    <li>Users → Active users → Select target user</li>
                    <li>Authentication methods → Remove admin's phone → Add target user's phone</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>Phase 3: Autopilot Registration <span class="status-badge status-warning">Skip if Pre-Registered</span></h2>
            <div class="alert alert-warning">
                <strong>IMPORTANT:</strong> Only complete this phase if device was NOT Dell pre-provisioned AND device hardware hash is NOT already imported. If Dell pre-provisioned or pre-registered, skip to Phase 4.
            </div>

            <h3>PowerShell Registration</h3>
            <div class="checklist-item">
                <input type="checkbox" id="reg-powershell">
                <label for="reg-powershell">Opened PowerShell as Administrator</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="reg-commands">
                <label for="reg-commands">Executed all 4 registration commands successfully</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="reg-auth">
                <label for="reg-auth">Completed authentication (if prompted)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="reg-success">
                <label for="reg-success">Received "Device is registered" success message</label>
            </div>

            <div class="quick-ref">
                <h4>Autopilot Registration Commands</h4>
                <pre><code>[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
Set-ExecutionPolicy -Scope Process -ExecutionPolicy RemoteSigned
Install-Script -Name Get-WindowsAutopilotInfo -Force
Get-WindowsAutopilotInfo -Online</code></pre>
            </div>

            <h3>Verification</h3>
            <div class="checklist-item">
                <input type="checkbox" id="reg-verify-portal">
                <label for="reg-verify-portal">Verified device appears in Endpoint Manager (may take 15 minutes)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="reg-verify-status">
                <label for="reg-verify-status">Device status shows "Assigned" or "Ready"</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="reg-verify-profile">
                <label for="reg-verify-profile">Deployment profile assignment verified</label>
            </div>

        </div>

        <div class="section">
            <h2>Phase 4: Enrollment Status Page (ESP) & Policy Deployment</h2>
            <div class="alert alert-info">
                <strong>ESP Timeout:</strong> 60 minutes. Do NOT interrupt the ESP screen during enrollment.
            </div>

            <h3>Wait Period</h3>
            <div class="checklist-item">
                <input type="checkbox" id="esp-started">
                <label for="esp-started">ESP screen appeared (showing enrollment progress)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="esp-wait">
                <label for="esp-wait">Waited full 15-20 minutes for policy deployment</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="esp-restarts">
                <label for="esp-restarts">Device restarted 1-2 times (normal behavior)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="esp-complete">
                <label for="esp-complete">ESP completed successfully (or allowed device use on failure)</label>
            </div>

            <h3>Expected Application Installation</h3>
            <div class="checklist-item">
                <input type="checkbox" id="app-chrome">
                <label for="app-chrome">Google Chrome - Installed and set as default browser</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="app-foxit">
                <label for="app-foxit">Foxit PDF Reader - Installed and set as default PDF viewer</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="app-office">
                <label for="app-office">Office 365 desktop app - Installed (includes Outlook Classic)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="app-teams">
                <label for="app-teams">Microsoft Teams (work and school) - Installed</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="app-onedrive">
                <label for="app-onedrive">OneDrive sync - Running and syncing</label>
            </div>


            <div class="alert alert-warning">
                <strong>If Office 365 not installed:</strong> Navigate to portal.office.com → Install Office → Office 365 apps
            </div>
        </div>

        <div class="section">
            <h2>Phase 5: Post-Deployment Verification</h2>

            <h3>Required Applications & Services</h3>
            <div class="checklist-item">
                <input type="checkbox" id="verify-ninja">
                <label for="verify-ninja"><strong>NinjaOne RMM Agent</strong> - System Tray icon visible, device appears in NinjaOne console with correct site</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-rdp">
                <label for="verify-rdp"><strong>RDP Icon/Shortcut</strong> - Visible on Desktop or Taskbar</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-rfms">
                <label for="verify-rfms"><strong>RFMS Access</strong> - RDP connection to RFMS server tested and working</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-taskbar">
                <label for="verify-taskbar"><strong>Taskbar Configuration</strong> - Pinned apps match standard layout, default shortcuts removed</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-vpn">
                <label for="verify-vpn"><strong>IPS VPN</strong> - Installed and available in Network settings (all users)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-power">
                <label for="verify-power"><strong>Power & Sleep Settings</strong> - Configured correctly (plugged in: never sleep, battery: 2hr screen/3hr sleep)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-timezone">
                <label for="verify-timezone"><strong>Time Zone</strong> - Set correctly for user's location</label>
            </div>

            <h3>Additional Verifications</h3>
            <div class="checklist-item">
                <input type="checkbox" id="verify-outlook">
                <label for="verify-outlook"><strong>Outlook</strong> - Installed and company account configured</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-teams-pinned">
                <label for="verify-teams-pinned"><strong>Teams</strong> - Pinned to taskbar, personal version removed</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-av">
                <label for="verify-av"><strong>Antivirus/Security</strong> - Active and up-to-date (Windows Defender or SentinelOne)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="verify-printers">
                <label for="verify-printers"><strong>Network Printers</strong> - Available in Printers and Scanners settings</label>
            </div>


            <h3>Issues Found</h3>
            <textarea class="notes" id="verification-issues" placeholder="List any missing items or issues found during verification..."></textarea>
        </div>

        <div class="section">
            <h2>Phase 6: Manual Configuration (If Needed)</h2>
            <div class="alert alert-info">
                <strong>Only complete items that were missing in Phase 5</strong>
            </div>

            <div class="checklist-item">
                <input type="checkbox" id="manual-rfms">
                <label for="manual-rfms">RFMS RDP connection configured and tested</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="manual-taskbar">
                <label for="manual-taskbar">Taskbar configured correctly (pinned/unpinned apps adjusted)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="manual-printers">
                <label for="manual-printers">Network printers installed (if needed)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="manual-vpn">
                <label for="manual-vpn">IPS VPN installed manually (if needed)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="manual-power">
                <label for="manual-power">Power and sleep settings configured manually</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="manual-timezone">
                <label for="manual-timezone">Time zone set manually</label>
            </div>

            <h3>Manual Configuration Notes</h3>
            <textarea class="notes" id="manual-notes" placeholder="Document any manual configuration steps performed..."></textarea>
        </div>

        <div class="section">
            <h2>Phase 7: Final Handoff Preparation</h2>

            <h3>Final Checks</h3>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-verify-all">
                <label for="handoff-verify-all">All verification items from Phase 5 are complete</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-mfa">
                <label for="handoff-mfa">MFA registration verified for target user (not admin's phone)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-teams">
                <label for="handoff-teams">Teams sign-in tested and working</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-internet">
                <label for="handoff-internet">Internet connectivity tested</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-rdp">
                <label for="handoff-rdp">RDP access to RFMS tested</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-vpn">
                <label for="handoff-vpn">VPN connection tested (if applicable)</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-printers">
                <label for="handoff-printers">Printer access tested</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-power">
                <label for="handoff-power">Power settings verified</label>
            </div>
            <div class="checklist-item">
                <input type="checkbox" id="handoff-signout">
                <label for="handoff-signout">Admin account signed out (Settings → Accounts → Your info → Sign out)</label>
            </div>


            <div class="alert alert-success">
                <strong>Device Ready for End User!</strong> The device is now ready for handoff. End user will sign in with their own organizational account when they receive it.
            </div>
        </div>

        <div class="section">
            <h2>Quick Reference</h2>

            <div class="quick-ref">
                <h4>Important Links</h4>
                <ul>
                    <li><strong>Microsoft Endpoint Manager:</strong> <a href="https://endpoint.microsoft.com" target="_blank">endpoint.microsoft.com</a></li>
                    <li><strong>Microsoft 365 Admin Center:</strong> <a href="https://admin.microsoft.com" target="_blank">admin.microsoft.com</a></li>
                    <li><strong>Azure AD Portal:</strong> <a href="https://portal.azure.com" target="_blank">portal.azure.com</a></li>
                    <li><strong>Office Portal:</strong> <a href="https://portal.office.com" target="_blank">portal.office.com</a></li>
                </ul>
            </div>

            <div class="quick-ref">
                <h4>Troubleshooting Quick Tips</h4>
                <ul>
                    <li><strong>Autopilot registration failed:</strong> Verify account has Intune admin rights; retry command</li>
                    <li><strong>Apps not installing after 20 min:</strong> Restart device; wait another 10 min; sync in Settings → Accounts → Access work or school</li>
                    <li><strong>RFMS access not working:</strong> Verify network connectivity; check RFMS server address</li>
                    <li><strong>RDP icon missing:</strong> Create shortcut manually: Right-click Desktop → New → Shortcut → <code>mstsc.exe</code></li>
                    <li><strong>Device not in Endpoint Manager:</strong> Wait up to 15 min; may need enrollment retry</li>
                    <li><strong>ESP stuck:</strong> Check Intune portal for device enrollment status; review device logs</li>
                </ul>
            </div>
        </div>

        <div class="signoff">
            <h2>Engineer Sign-Off</h2>
            <p>Complete this section to document successful device deployment:</p>

            <div class="signoff-grid">
                <div class="signoff-item">
                    <label for="signoff-engineer">Engineer Name</label>
                    <input type="text" id="signoff-engineer" placeholder="Full name">
                </div>
                <div class="signoff-item">
                    <label for="signoff-date">Completion Date</label>
                    <input type="date" id="signoff-date">
                </div>
                <div class="signoff-item">
                    <label for="signoff-status">Deployment Status</label>
                    <select id="signoff-status">
                        <option value="">Select status...</option>
                        <option value="success">✓ Successful - Device ready for end user</option>
                        <option value="partial">⚠ Partial - Some issues remain</option>
                        <option value="failed">✗ Failed - Deployment incomplete</option>
                    </select>
                </div>
            </div>

            <div style="margin-top: 1.5rem;">
                <label for="signoff-issues" style="font-weight: bold; color: var(--accent-primary); display: block; margin-bottom: 0.5rem;">Issues Encountered (if any)</label>
                <textarea class="notes" id="signoff-issues" placeholder="Describe any issues, special notes, or items that need follow-up..."></textarea>
            </div>

            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                <p style="font-size: 0.95rem; color: var(--text-secondary);">
                    <strong>Confirmation:</strong> I confirm that this device has been successfully deployed according to the Impact Property Solutions Windows Device Deployment Guide and is ready for end-user handoff.
                </p>
            </div>
        </div>
    </div>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('worksheet-theme', newTheme);
            
            const button = document.querySelector('.theme-toggle');
            button.textContent = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';
        }

        // Load saved theme preference
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('worksheet-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            const button = document.querySelector('.theme-toggle');
            button.textContent = savedTheme === 'dark' ? 'Light Mode' : 'Dark Mode';

            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('deployment-date');
            const signoffDateInput = document.getElementById('signoff-date');
            if (dateInput && !dateInput.value) {
                dateInput.value = today;
            }
            if (signoffDateInput && !signoffDateInput.value) {
                signoffDateInput.value = today;
            }

            // Auto-save all form data to localStorage
            const allInputs = document.querySelectorAll('input, select, textarea');
            allInputs.forEach(element => {
                const key = 'worksheet-' + element.id;
                
                // Load saved value
                const saved = localStorage.getItem(key);
                if (saved) {
                    if (element.type === 'checkbox') {
                        element.checked = saved === 'true';
                    } else {
                        element.value = saved;
                    }
                }

                // Save on change
                element.addEventListener('change', function() {
                    const value = element.type === 'checkbox' ? element.checked : element.value;
                    localStorage.setItem(key, value);
                });
            });

            // Auto-populate hostname from serial if device naming template is IMP-%SERIAL%
            const serialInput = document.getElementById('device-serial');
            const hostnameInput = document.getElementById('device-hostname');
            if (serialInput && hostnameInput) {
                serialInput.addEventListener('blur', function() {
                    if (this.value && !hostnameInput.value) {
                        hostnameInput.value = 'IMP-' + this.value.toUpperCase();
                    }
                });
            }
        });
    </script>
</body>
</html>

